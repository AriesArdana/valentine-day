<!doctype html>
<html lang="en" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Valentine Letter</title>
  <script src="https://cdn.tailwindcss.com/3.4.17"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&amp;family=Quicksand:wght@300;400;500;600&amp;display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; }
    
    .dancing-font { font-family: 'Dancing Script', cursive; }
    .quicksand-font { font-family: 'Quicksand', sans-serif; }
    
    @keyframes float-hearts {
      0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
      10% { opacity: 1; }
      90% { opacity: 1; }
      100% { transform: translateY(-100px) rotate(360deg); opacity: 0; }
    }
    
    @keyframes pulse-glow {
      0%, 100% { filter: drop-shadow(0 0 8px currentColor); }
      50% { filter: drop-shadow(0 0 20px currentColor); }
    }
    
    @keyframes envelope-bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }
    
    @keyframes sparkle {
      0%, 100% { opacity: 0; transform: scale(0); }
      50% { opacity: 1; transform: scale(1); }
    }
    
    @keyframes float-up {
      0% { opacity: 0; transform: translateY(40px); }
      100% { opacity: 1; transform: translateY(0); }
    }
    
    .floating-heart {
      animation: float-hearts 12s linear infinite;
    }
    
    .seal-pulse {
      animation: pulse-glow 2s ease-in-out infinite;
    }
    
    .envelope-idle {
      animation: envelope-bounce 3s ease-in-out infinite;
    }
    
    .sparkle {
      animation: sparkle 2s ease-in-out infinite;
    }
    
    .envelope-flap {
      transform-style: preserve-3d;
      transform-origin: top center;
      transition: transform 1s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .envelope-flap.open {
      transform: rotateX(-180deg);
    }
    
    .letter-content {
      animation: float-up 0.8s ease-out forwards;
    }
    
    .seal-button {
      transition: all 0.3s ease;
    }
    
    .seal-button:hover {
      transform: scale(1.2);
    }
    
    .seal-button:active {
      transform: scale(0.9);
    }
    
    .fade-in {
      animation: fadeIn 0.8s ease-out forwards;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .slide-up {
      animation: slideUp 0.6s ease-out forwards;
    }
    
    @keyframes slideUp {
      from { opacity: 0; transform: translateY(40px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .btn-hover {
      transition: all 0.3s ease;
    }
    
    .btn-hover:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(236, 72, 153, 0.4);
    }
    
    .gradient-text {
      background: linear-gradient(135deg, #ec4899, #f43f5e, #fb7185);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .spotify-card {
      cursor: pointer;
      transition: all 0.3s ease;
      transform: scale(1);
    }

    .spotify-card:hover {
      transform: scale(1.05);
      box-shadow: 0 20px 40px rgba(236, 72, 153, 0.3);
    }

    .spotify-card:active {
      transform: scale(0.95);
    }
  </style>
  <style>body { box-sizing: border-box; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full m-0 p-0 quicksand-font">
  <div id="app" class="h-full w-full relative overflow-hidden" style="background: linear-gradient(135deg, #fdf2f8 0%, #fce7f3 50%, #fbcfe8 100%);"><!-- Floating Hearts Background -->
   <div id="hearts-container" class="absolute inset-0 pointer-events-none overflow-hidden z-0"></div><!-- Sparkles -->
   <div id="sparkles-container" class="absolute inset-0 pointer-events-none overflow-hidden z-0"></div><!-- Main Content -->
   <div class="relative z-10 h-full w-full flex flex-col items-center justify-center p-4"><!-- Slide 1: Welcome -->
    <div id="slide-1" class="flex flex-col items-center justify-center gap-6 text-center">
     <h1 id="main-title" class="text-4xl sm:text-5xl md:text-6xl font-bold gradient-text dancing-font fade-in" style="animation-delay: 0.2s;">HAPPY VALENTINE</h1>
     <p id="subtitle" class="text-lg sm:text-xl text-pink-600 font-medium slide-up" style="animation-delay: 0.5s;">For <span id="recipient-display" class="font-bold text-rose-500">Calista</span> ğŸ’•</p><button id="start-btn" class="mt-4 px-8 py-3 bg-gradient-to-r from-pink-500 to-rose-500 text-white rounded-full font-semibold text-lg shadow-lg btn-hover slide-up" style="animation-delay: 0.8s;" onclick="showEnvelope()"> Ada Sesuatu Untukmu âœ¨ </button>
    </div><!-- Slide 2: Envelope -->
    <div id="slide-2" class="hidden flex-col items-center justify-center gap-6"><!-- Envelope Container -->
     <div class="relative w-80 h-60 flex items-end justify-center envelope-idle" id="envelope-container"><!-- Letter Content -->
      <div id="letter-paper" class="absolute w-64 bg-white rounded-xl shadow-2xl p-5 z-30 hidden" style="bottom: 80px;">
       <h3 id="letter-recipient" class="text-xl font-bold text-pink-600 dancing-font mb-3">For Calista</h3>
       <p id="letter-text" class="text-sm text-gray-700 leading-relaxed quicksand-font whitespace-pre-line">happy valentine ya, semoga hari ini kamu ngerasa hangat, dan ditemenin hal-hal yang bikin kamu senyum, dan semoga, sedikit banyak, aku bisa jadi salah satu hal yang bikin harimu terasa lebih baik</p>
       <div class="mt-4 text-center"><span class="text-2xl">ğŸ’</span>
       </div><button id="next-btn" class="w-full mt-4 py-2 bg-gradient-to-r from-pink-500 to-rose-500 text-white rounded-lg font-semibold shadow-lg btn-hover" onclick="goToMusic()"> Next âœ </button>
      </div><!-- Envelope Body -->
      <div id="envelope-body" class="absolute bottom-0 w-full h-44 rounded-2xl shadow-xl z-10" style="background: linear-gradient(135deg, #fbcfe8 0%, #fda4af 100%);"></div><!-- Envelope Inner Shadow -->
      <div class="absolute bottom-0 w-full h-44 rounded-2xl z-10 overflow-hidden">
       <div class="absolute inset-0" style="background: linear-gradient(to bottom, transparent 60%, rgba(0,0,0,0.05) 100%);"></div>
      </div><!-- Envelope Flap -->
      <div id="envelope-flap" class="envelope-flap absolute w-full z-20" style="bottom: 50px;">
       <svg viewbox="0 0 320 130" class="w-full"><defs>
         <lineargradient id="flapGradient" x1="0%" y1="0%" x2="100%" y2="100%">
          <stop offset="0%" style="stop-color:#f9a8d4" />
          <stop offset="100%" style="stop-color:#fb7185" />
         </lineargradient>
        </defs> <path d="M0,0 L160,110 L320,0 L320,0 L0,0 Z" fill="url(#flapGradient)" /> <path d="M0,0 L160,110 L320,0" fill="none" stroke="#ec4899" stroke-width="1" opacity="0.3" />
       </svg>
      </div><!-- Heart Seal -->
      <div id="heart-seal" class="absolute z-40 cursor-pointer seal-button left-1/2 transform -translate-x-1/2" style="bottom: 115px;">
       <div class="text-5xl seal-pulse" style="color: #e11d48;">
        â¤ï¸
       </div>
       <p class="text-xs text-pink-600 font-medium mt-1 text-center opacity-80">Tap untuk buka</p>
      </div>
     </div>
     <p id="envelope-hint" class="text-pink-500 font-medium text-sm mt-4 opacity-70">Ketuk hati untuk membuka amplop ğŸ’•</p>
    </div><!-- Slide 3: Music -->
    <div id="slide-3" class="hidden flex-col items-center justify-center gap-6 text-center h-full">
     <div class="flex-1 flex flex-col items-center justify-center gap-6">
      <h2 class="text-3xl sm:text-4xl font-bold gradient-text dancing-font fade-in" style="animation-delay: 0.2s;">This Music Reminds Me of You ğŸµ</h2><!-- Spotify Card -->
      <div id="spotify-card" class="spotify-card mt-4 rounded-2xl overflow-hidden shadow-2xl fade-in" style="animation-delay: 0.4s; cursor: pointer;">
       <div id="spotify-logo" style="background: linear-gradient(135deg, #1DB954 0%, #1ed760 100%); width: 240px; height: 240px; display: flex; align-items: center; justify-content: center; font-size: 120px;">
        ğŸµ
       </div>
       <div class="bg-black bg-opacity-90 p-6 text-center">
        <p class="text-white font-semibold text-lg mb-2">Click to Listen</p>
        <p class="text-green-400 text-sm">Open on Spotify â†’</p>
       </div>
      </div>
      <p class="text-pink-600 font-medium text-sm max-w-md mt-4">Click the card to open the song on Spotify ğŸ’š</p>
     </div>
    </div><!-- Slide 4: Final Message -->
    <div id="slide-4" class="hidden flex-col items-center justify-center gap-6 text-center p-6">
     <div class="text-6xl mb-4 fade-in" style="animation-delay: 0.2s;">
      ğŸ’–
     </div>
     <h2 class="text-3xl sm:text-4xl font-bold gradient-text dancing-font fade-in" style="animation-delay: 0.4s;">With Love</h2>
     <p class="text-lg text-pink-600 max-w-md fade-in" style="animation-delay: 0.6s;">Semoga harimu indah dan penuh kebahagiaan!</p><button id="restart-btn" class="mt-6 px-6 py-2 bg-white text-pink-500 rounded-full font-semibold shadow-lg border-2 border-pink-300 btn-hover fade-in" style="animation-delay: 0.8s;" onclick="restart()"> Lihat Lagi ğŸ”„ </button>
    </div>
   </div>
  </div>
  <script>
    // Default configuration
    const defaultConfig = {
      recipient_name: 'Calista',
      letter_message: 'happy valentine ya, semoga hari ini kamu ngerasa hangat, dan ditemenin hal-hal yang bikin kamu senyum, dan semoga, sedikit banyak, aku bisa jadi salah satu hal yang bikin harimu terasa lebih baik',
      spotify_link: 'https://open.spotify.com/track/6H67gFuycHyTOROX2M4bbs?si=RIm8P_DxTtmHRTapV3_p8w',
      spotify_emoji: 'ğŸµ',
      background_color: '#fdf2f8',
      accent_color: '#ec4899',
      text_color: '#831843',
      button_color: '#f43f5e',
      heart_color: '#e11d48'
    };

    let config = { ...defaultConfig };
    let sealBroken = false;
    let currentSlide = 1;

    // Create floating hearts
    function createFloatingHearts() {
      const container = document.getElementById('hearts-container');
      container.innerHTML = '';
      
      const hearts = ['ğŸ’–', 'ğŸ’•', 'ğŸ’—', 'ğŸ’', 'ğŸ’˜', 'ğŸ©·'];
      
      for (let i = 0; i < 12; i++) {
        const heart = document.createElement('div');
        heart.className = 'absolute text-2xl floating-heart';
        heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
        heart.style.left = `${Math.random() * 100}%`;
        heart.style.animationDelay = `${i * 0.8}s`;
        heart.style.animationDuration = `${10 + Math.random() * 5}s`;
        container.appendChild(heart);
      }
    }

    // Create sparkles
    function createSparkles() {
      const container = document.getElementById('sparkles-container');
      container.innerHTML = '';
      
      for (let i = 0; i < 8; i++) {
        const sparkle = document.createElement('div');
        sparkle.className = 'absolute sparkle';
        sparkle.textContent = 'âœ¨';
        sparkle.style.left = `${10 + Math.random() * 80}%`;
        sparkle.style.top = `${10 + Math.random() * 80}%`;
        sparkle.style.animationDelay = `${i * 0.4}s`;
        sparkle.style.fontSize = `${1 + Math.random() * 1}rem`;
        container.appendChild(sparkle);
      }
    }

    // Show envelope slide
    function showEnvelope() {
      document.getElementById('slide-1').classList.add('hidden');
      document.getElementById('slide-2').classList.remove('hidden');
      document.getElementById('slide-2').classList.add('flex');
      currentSlide = 2;
    }

    // Break seal and open envelope
    function breakSeal() {
      if (sealBroken) return;
      sealBroken = true;
      
      // Hide seal
      const seal = document.getElementById('heart-seal');
      seal.style.transition = 'all 0.5s ease';
      seal.style.transform = 'scale(0) translateX(-50%)';
      seal.style.opacity = '0';
      seal.style.pointerEvents = 'none';
      
      // Open flap
      setTimeout(() => {
        document.getElementById('envelope-flap').classList.add('open');
      }, 300);
      
      // Show letter
      setTimeout(() => {
        const letter = document.getElementById('letter-paper');
        letter.classList.remove('hidden');
        letter.classList.add('letter-content');
        
        // Stop envelope bounce
        document.getElementById('envelope-container').classList.remove('envelope-idle');
      }, 800);
      
      // Hide hint
      document.getElementById('envelope-hint').style.opacity = '0';
    }

    // Go to music slide
    function goToMusic() {
      document.getElementById('slide-2').classList.add('hidden');
      document.getElementById('slide-2').classList.remove('flex');
      document.getElementById('slide-3').classList.remove('hidden');
      document.getElementById('slide-3').classList.add('flex');
      currentSlide = 3;
    }

    // Open spotify link
    function openSpotify() {
      const link = config.spotify_link || defaultConfig.spotify_link;
      if (link) {
        window.open(link, '_blank', 'noopener,noreferrer');
      }

      // Move to final slide after delay
      setTimeout(() => {
        document.getElementById('slide-3').classList.add('hidden');
        document.getElementById('slide-3').classList.remove('flex');
        document.getElementById('slide-4').classList.remove('hidden');
        document.getElementById('slide-4').classList.add('flex');
        currentSlide = 4;
      }, 3000);
    }

    // Restart experience
    function restart() {
      sealBroken = false;
      currentSlide = 1;
      
      // Reset all slides
      document.getElementById('slide-1').classList.remove('hidden');
      document.getElementById('slide-2').classList.add('hidden');
      document.getElementById('slide-2').classList.remove('flex');
      document.getElementById('slide-3').classList.add('hidden');
      document.getElementById('slide-3').classList.remove('flex');
      document.getElementById('slide-4').classList.add('hidden');
      document.getElementById('slide-4').classList.remove('flex');
      
      // Reset envelope
      document.getElementById('envelope-flap').classList.remove('open');
      document.getElementById('envelope-container').classList.add('envelope-idle');
      
      // Reset seal
      const seal = document.getElementById('heart-seal');
      seal.style.transform = 'scale